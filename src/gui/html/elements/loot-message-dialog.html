<!--
<loot-message-dialog> provides a simple interface for supplying a dialog
consisting of a:

* title
* message
* accept button
* cancel button (optional)

It also allows for a callback function to be executed on dialog close.
The function takes one boolean parameter that is true if the accept button
was pressed.
-->

<link rel="import" href="../../../../bower_components/polymer/polymer.html">

<link rel="import" href="../../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../../../bower_components/paper-dialog/paper-dialog.html">

<link rel="import" href="../../../../bower_components/neon-animation/animations/fade-in-animation.html">
<link rel="import" href="../../../../bower_components/neon-animation/animations/fade-out-animation.html">

<dom-module id="loot-message-dialog">
    <template>
        <style>
        paper-dialog {
            margin: 24px 40px;
              max-width: 50%;

            --paper-dialog-title: {
                font-weight: 500;
                font-size: 1.429rem;
            };
        }
        </style>
        <paper-dialog id="dialog"
                      entry-animation="fade-in-animation"
                      exit-animation="fade-out-animation"
                      modal>
            <content></content>
        </paper-dialog>
    </template>
    <script>
    Polymer({
        is: 'loot-message-dialog',
        closeCallback: undefined,

        setButtonText: function(accept, cancel) {
            this.getElementsByClassName('accept')[0].textContent = accept;
            this.getElementsByClassName('cancel')[0].textContent = cancel;

            if (!cancel) {
                this.getElementsByClassName('cancel')[0].classList.toggle('hidden', true);
            } else {
                this.getElementsByClassName('cancel')[0].classList.toggle('hidden', false);
            }
        },

        onClose: function(evt) {
            if (evt.target.parentNode.host.closeCallback) {
                evt.target.parentNode.host.closeCallback(evt.target.closingReason.confirmed == true);
            }
            evt.target.parentNode.host.parentElement.removeChild(evt.target.parentNode.host);
        },

        showModal: function(title, text, closeCallback) {
            this.getElementsByClassName('heading')[0].textContent = title;
            this.getElementsByClassName('message')[0].textContent = text;

            this.closeCallback = closeCallback;
            this.$.dialog.open();
        },

        close: function() {
            this.$.dialog.close();
        },

        created: function() {
            var h2 = document.createElement('h2');
            h2.className = 'heading';
            this.appendChild(h2);

            var p = document.createElement('p');
            p.className = 'message';
            this.appendChild(p);

            var buttons = document.createElement('div');
            buttons.className = 'buttons';
            this.appendChild(buttons);

            var accept = document.createElement('paper-button');
            accept.className = 'accept';
            accept.setAttribute('dialog-confirm', true);
            accept.setAttribute('autofocus', true);
            accept.textContent = 'Apply';
            buttons.appendChild(accept);

            var cancel = document.createElement('paper-button');
            cancel.className = 'cancel';
            cancel.setAttribute('dialog-dismiss', true);
            cancel.textContent = 'Cancel';
            buttons.appendChild(cancel);
        },

        attached: function() {
            this.$.dialog.addEventListener('iron-overlay-closed', this.onClose, false);
        },

        detached: function() {
            this.$.dialog.removeEventListener('iron-overlay-closed', this.onClose, false);
        },
    });
    </script>
</dom-module>
